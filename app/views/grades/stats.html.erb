<h1><%= @school_class.name %></h1>

<table class="table table-striped">
  <thead>
    <tr>
      <td>Category</td>
      <td>Overall Average</td>
    </tr>
  </thead>
  <tbody>
    <% @answer.each do |k,c|%>
    <tr>
      <td>
        <%= link_to k do %>
        <%= k %><br>
        <% end %>
      </td>
      <td>
      <%= c %>
      </td>
    </tr>
    <% end %>
  </tbody>
</table>


<table class="table table-striped">
  <thead>
    <tr>
      <td>Assignmnet Name</td>
      <td>Category</td>
      <td>Average Grade</td>
     <!-- <td>Max Points</td>  How could we display this? -->
    </tr>
  </thead>
  <tbody>

    <% @assignments.each do |assignment| %>
    <tr>
      <td>
        <%= link_to assignment do %>
        <%= assignment.name %>
      </td>
      <% end %>
      <td>
        <%= assignment.category %>
      </td>
      <td data-id="<%= assignment.id %>" >
        <% total = [] %>
        <% assignment.grades.each do |pts| %>
        <% total << pts.earned_points %>
        <% end %>
        <% av = total.reduce(:+) %>
        <% size = total.length %>

        <div class="toggle-views" data-id="<%= assignment.id %>" >
          <div class="points">
            <%= av / size.to_f %>
          </div>

          <div  class="ppoints hidden"  >
            <%= ((((av / size.to_f) / assignment.max_points) * 100).floor).to_s + " %"%>
          </div>

        </div>

      </td>
      <!-- <td><%= assignment.max_points %></td>  Makes Table too wide -->
    <% end %>

    </tr>

  </tbody>
</table>


<script>
  $(document).ready(function() {
    $('.toggle-views').on('click', function() {
      console.log('select worx');
      var id = $(this).attr('data-id');
      $('[data-id=' + id + '] .ppoints').toggleClass("hidden");
      $('[data-id=' + id + '] .points').toggleClass("hidden");
    });
  });
</script>
